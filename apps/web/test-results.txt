
> test
> jest --passWithNoTests chat.test.tsx --no-coverage --maxWorkers=1

  console.error
    Error: Uncaught [TypeError: games.map is not a function]
        at reportException (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
        at innerInvokeEventListeners (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
        at invokeEventListeners (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
        at HTMLUnknownElementImpl._dispatch (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
        at HTMLUnknownElementImpl.dispatchEvent (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
        at HTMLUnknownElement.dispatchEvent (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
        at Object.invokeGuardedCallbackDev (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
        at invokeGuardedCallback (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
        at beginWork$1 (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
        at performUnitOfWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
        at workLoopSync (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
        at renderRootSync (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
        at performConcurrentWorkOnRoot (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
        at workLoop (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:266:34)
        at flushWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:239:14)
        at performWorkUntilDeadline (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:533:21)
        at Timeout.task [as _onTimeout] (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\browser\Window.js:579:19)
        at listOnTimeout (node:internal/timers:588:17)
        at processTimers (node:internal/timers:523:7) {
      detail: TypeError: games.map is not a function
          at map (D:\Repositories\meepleai-monorepo\apps\web\src\pages\chat.tsx:551:22)
          at renderWithHooks (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
          at updateFunctionComponent (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:19617:20)
          at beginWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:21640:16)
          at HTMLUnknownElement.callCallback (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
          at HTMLUnknownElement.callTheUserObjectsOperation (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
          at innerInvokeEventListeners (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
          at invokeEventListeners (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:25777:74)
          at workLoop (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:266:34)
          at flushWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:239:14)
          at performWorkUntilDeadline (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:533:21)
          at Timeout.task [as _onTimeout] (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\browser\Window.js:579:19)
          at listOnTimeout (node:internal/timers:588:17)
          at processTimers (node:internal/timers:523:7),
      type: 'unhandled exception'
    }

      at VirtualConsole.<anonymous> (node_modules/.pnpm/@jest+environment-jsdom-abstract@30.2.0_jsdom@26.1.0/node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
      at reportException (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at workLoop (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:266:34)
      at flushWork (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:239:14)
      at performWorkUntilDeadline (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:533:21)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  console.error
    Error: Uncaught [TypeError: games.map is not a function]
        at reportException (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
        at innerInvokeEventListeners (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:353:9)
        at invokeEventListeners (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
        at HTMLUnknownElementImpl._dispatch (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
        at HTMLUnknownElementImpl.dispatchEvent (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
        at HTMLUnknownElement.dispatchEvent (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
        at Object.invokeGuardedCallbackDev (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
        at invokeGuardedCallback (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
        at beginWork$1 (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
        at performUnitOfWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
        at workLoopSync (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
        at renderRootSync (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
        at recoverFromConcurrentError (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
        at performConcurrentWorkOnRoot (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
        at workLoop (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:266:34)
        at flushWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:239:14)
        at performWorkUntilDeadline (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:533:21)
        at Timeout.task [as _onTimeout] (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\browser\Window.js:579:19)
        at listOnTimeout (node:internal/timers:588:17)
        at processTimers (node:internal/timers:523:7) {
      detail: TypeError: games.map is not a function
          at map (D:\Repositories\meepleai-monorepo\apps\web\src\pages\chat.tsx:551:22)
          at renderWithHooks (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
          at updateFunctionComponent (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:19617:20)
          at beginWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:21640:16)
          at HTMLUnknownElement.callCallback (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:4164:14)
          at HTMLUnknownElement.callTheUserObjectsOperation (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
          at innerInvokeEventListeners (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:350:25)
          at invokeEventListeners (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:4213:16)
          at invokeGuardedCallback (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:4277:31)
          at beginWork$1 (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:27490:7)
          at performUnitOfWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at workLoop (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:266:34)
          at flushWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:239:14)
          at performWorkUntilDeadline (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:533:21)
          at Timeout.task [as _onTimeout] (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\browser\Window.js:579:19)
          at listOnTimeout (node:internal/timers:588:17)
          at processTimers (node:internal/timers:523:7),
      type: 'unhandled exception'
    }

      at VirtualConsole.<anonymous> (node_modules/.pnpm/@jest+environment-jsdom-abstract@30.2.0_jsdom@26.1.0/node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
      at reportException (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at beginWork$1 (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
      at performUnitOfWork (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at workLoop (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:266:34)
      at flushWork (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:239:14)
      at performWorkUntilDeadline (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:533:21)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  console.error
    The above error occurred in the <ChatPage> component:
    
        at ChatPage (D:\Repositories\meepleai-monorepo\apps\web\src\pages\chat.tsx:102:43)
    
    Consider adding an error boundary to your tree to customize error handling behavior.
    Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

      at logCapturedError (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at finishConcurrentRender (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:25931:9)
      at performConcurrentWorkOnRoot (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:25848:7)
      at workLoop (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:266:34)
      at flushWork (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:239:14)
      at performWorkUntilDeadline (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:533:21)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  console.error
    Error: Uncaught [TypeError: games.map is not a function]
        at reportException (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
        at Timeout.task [as _onTimeout] (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\browser\Window.js:584:9)
        at listOnTimeout (node:internal/timers:588:17)
        at processTimers (node:internal/timers:523:7) {
      detail: TypeError: games.map is not a function
          at map (D:\Repositories\meepleai-monorepo\apps\web\src\pages\chat.tsx:551:22)
          at renderWithHooks (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:15486:18)
          at updateFunctionComponent (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:19617:20)
          at beginWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:21640:16)
          at beginWork$1 (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:27465:14)
          at performUnitOfWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26599:12)
          at workLoopSync (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26505:5)
          at renderRootSync (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:26473:7)
          at recoverFromConcurrentError (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:25889:20)
          at performConcurrentWorkOnRoot (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\react-dom@18.3.1_react@18.3.1\node_modules\react-dom\cjs\react-dom.development.js:25789:22)
          at workLoop (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:266:34)
          at flushWork (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:239:14)
          at performWorkUntilDeadline (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\scheduler@0.23.2\node_modules\scheduler\cjs\scheduler.development.js:533:21)
          at Timeout.task [as _onTimeout] (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jsdom@26.1.0\node_modules\jsdom\lib\jsdom\browser\Window.js:579:19)
          at listOnTimeout (node:internal/timers:588:17)
          at processTimers (node:internal/timers:523:7),
      type: 'unhandled exception'
    }

      at VirtualConsole.<anonymous> (node_modules/.pnpm/@jest+environment-jsdom-abstract@30.2.0_jsdom@26.1.0/node_modules/@jest/environment-jsdom-abstract/build/index.js:87:23)
      at reportException (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:584:9)

  console.error
    Error loading games: Error: Games API failed
        at Object.<anonymous> (D:\Repositories\meepleai-monorepo\apps\web\src\pages\__tests__\chat.test.tsx:281:41)
        at Promise.finally.completed (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1497:10)
        at _callCircusTest (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1007:40)
        at _runTest (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:947:3)
        at D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:857:11)
        at run (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1918:21)
        at jestAdapter (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\runner.js:101:19)
        at runTestInternal (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-runner@30.2.0\node_modules\jest-runner\build\index.js:275:16)
        at runTest (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-runner@30.2.0\node_modules\jest-runner\build\index.js:343:7)

    [0m [90m 181 |[39m       }
     [90m 182 |[39m     } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 183 |[39m       console[33m.[39merror([32m"Error loading games:"[39m[33m,[39m err)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 184 |[39m       setErrorMessage([32m"Errore nel caricamento dei giochi."[39m)[33m;[39m
     [90m 185 |[39m       setGames([])[33m;[39m
     [90m 186 |[39m     } [36mfinally[39m {[0m

      at error (src/pages/chat.tsx:183:15)

  console.error
    Error loading agents: Error: Agents API failed
        at Object.<anonymous> (D:\Repositories\meepleai-monorepo\apps\web\src\pages\__tests__\chat.test.tsx:296:41)
        at Promise.finally.completed (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1497:10)
        at _callCircusTest (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1007:40)
        at _runTest (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:947:3)
        at D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:857:11)
        at run (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1918:21)
        at jestAdapter (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\runner.js:101:19)
        at runTestInternal (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-runner@30.2.0\node_modules\jest-runner\build\index.js:275:16)
        at runTest (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-runner@30.2.0\node_modules\jest-runner\build\index.js:343:7)

    [0m [90m 201 |[39m       }
     [90m 202 |[39m     } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 203 |[39m       console[33m.[39merror([32m"Error loading agents:"[39m[33m,[39m err)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 204 |[39m       setErrorMessage([32m"Errore nel caricamento degli agenti."[39m)[33m;[39m
     [90m 205 |[39m       setAgents([])[33m;[39m
     [90m 206 |[39m     } [36mfinally[39m {[0m

      at error (src/pages/chat.tsx:203:15)

  console.error
    Error loading chats: Error: Chats API failed
        at Object.<anonymous> (D:\Repositories\meepleai-monorepo\apps\web\src\pages\__tests__\chat.test.tsx:313:41)
        at Promise.finally.completed (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1497:10)
        at _callCircusTest (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1007:40)
        at _runTest (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:947:3)
        at D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:857:11)
        at run (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\jestAdapterInit.js:1918:21)
        at jestAdapter (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-circus@30.2.0\node_modules\jest-circus\build\runner.js:101:19)
        at runTestInternal (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-runner@30.2.0\node_modules\jest-runner\build\index.js:275:16)
        at runTest (D:\Repositories\meepleai-monorepo\apps\web\node_modules\.pnpm\jest-runner@30.2.0\node_modules\jest-runner\build\index.js:343:7)

    [0m [90m 215 |[39m       setChats(chatsList [33m?[39m[33m?[39m [])[33m;[39m
     [90m 216 |[39m     } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 217 |[39m       console[33m.[39merror([32m"Error loading chats:"[39m[33m,[39m err)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 218 |[39m       [90m// Don't show error to user - empty chat list is acceptable[39m
     [90m 219 |[39m       setChats([])[33m;[39m
     [90m 220 |[39m     } [36mfinally[39m {[0m

      at error (src/pages/chat.tsx:217:15)

  console.error
    Error loading chat history: TypeError: Cannot read properties of undefined (reading 'map')
        at map (D:\Repositories\meepleai-monorepo\apps\web\src\pages\chat.tsx:233:68)

    [0m [90m 271 |[39m       }
     [90m 272 |[39m     } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 273 |[39m       console[33m.[39merror([32m"Error loading chat history:"[39m[33m,[39m err)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 274 |[39m       setErrorMessage([32m"Errore nel caricamento della cronologia chat."[39m)[33m;[39m
     [90m 275 |[39m     } [36mfinally[39m {
     [90m 276 |[39m       setIsLoadingMessages([36mfalse[39m)[33m;[39m[0m

      at error (src/pages/chat.tsx:273:15)

FAIL src/pages/__tests__/chat.test.tsx (42.915 s)
  ChatPage
    Authentication
      √ shows loading state initially (68 ms)
      √ shows unauthenticated state when user is not logged in (24 ms)
      √ shows authenticated interface when user is logged in (36 ms)
      √ handles authentication check failure gracefully (5 ms)
    Data Loading
      × loads games after authentication (1014 ms)
      × auto-selects first game when games are loaded (1011 ms)
      √ loads agents when game is selected (62 ms)
      √ auto-selects first agent when agents are loaded (32 ms)
      √ loads chats filtered by selected game (45 ms)
      × shows loading indicator while loading games (15 ms)
      √ shows loading indicator while loading chats (29 ms)
      × shows empty state when no games are available (73 ms)
      × shows empty state when no chats exist (1016 ms)
      × handles games loading error gracefully (1011 ms)
      × handles agents loading error gracefully (1015 ms)
      √ handles chats loading error gracefully without showing error (30 ms)
    Game and Agent Selection
      × allows changing game selection (1006 ms)
      × reloads agents when game changes (1008 ms)
      × clears active chat when game changes (1008 ms)
      × allows changing agent selection (60 ms)
      √ disables agent selector when no game is selected (92 ms)
    Chat Management
      Creating New Chat
        √ creates new chat when "Nuova Chat" button is clicked (107 ms)
        √ disables "Nuova Chat" button when no game is selected (97 ms)
        √ disables "Nuova Chat" button when no agent is selected (125 ms)
        √ shows loading state while creating chat (94 ms)
        √ handles chat creation error gracefully (119 ms)
      Loading Existing Chat
        × loads chat history when chat is clicked (122 ms)
        × shows loading indicator while loading chat history (1012 ms)
        × converts backend messages to frontend format correctly (1017 ms)
        × handles malformed metadata JSON gracefully (1003 ms)
        × synchronizes game and agent selection with loaded chat (139 ms)
        × handles chat history loading error gracefully (1016 ms)
      Deleting Chat
        × deletes chat when delete button is clicked and confirmed (1017 ms)
        √ does not delete chat when user cancels confirmation (92 ms)
        √ clears active chat when deleting the currently active chat (185 ms)
        × handles chat deletion error gracefully (1094 ms)
        √ stops click propagation on delete button to prevent loading chat (122 ms)
    Messaging
      Sending Messages
        × sends message with chatId when chat is active (1004 ms)
        √ auto-creates chat on first message when no chat is active (353 ms)
        × displays user message immediately and assistant response after API call (1005 ms)
        √ clears input after sending message (435 ms)
        × shows loading indicator while sending message (1124 ms)
        √ disables send button when no game is selected (98 ms)
        √ disables send button when no agent is selected (156 ms)
        √ disables send button when input is empty (45 ms)
        × disables send button when input contains only whitespace (1007 ms)
        √ does not send message when input is whitespace only (142 ms)
        × removes user message when message sending fails (1095 ms)
        × handles auto-creation failure when sending first message (1014 ms)
        × updates chat lastMessageAt timestamp after sending message (1007 ms)
      Displaying Messages
        × displays snippets with page numbers (1009 ms)
        × displays snippets without page numbers when page is null (1004 ms)
        × does not display snippets section when no snippets exist (1461 ms)
        √ displays message timestamps (109 ms)
    Feedback
      √ submits helpful feedback when thumbs up is clicked (204 ms)
      √ submits not-helpful feedback when thumbs down is clicked (186 ms)
      × toggles feedback to null when clicking same button twice (1101 ms)
      × changes feedback when switching between helpful and not-helpful (1007 ms)
      × reverts feedback state when API call fails (1018 ms)
      × uses backend message ID for feedback when available (1010 ms)
      × only shows feedback buttons for assistant messages (1115 ms)
    UI Interactions
      × toggles sidebar when collapse button is clicked (1010 ms)
      × shows game name in header when game is selected (1019 ms)
      × shows agent name in header when chat is active (1016 ms)
      √ shows default message when no chat is selected (27 ms)
      × highlights active chat in sidebar (124 ms)
      × formats chat preview with date and time (59 ms)
    Edge Cases
      × handles null auth response gracefully (49 ms)
      × handles empty games list (1003 ms)
      × handles empty agents list (1009 ms)
      × handles chat with null lastMessageAt (1011 ms)
      × handles message with null metadata (1125 ms)
      √ handles QA response without messageId (417 ms)
      √ handles chat creation returning null (355 ms)

  ● ChatPage › Data Loading › loads games after authentication

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/games"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 170 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 171 |[39m
    [31m[1m>[22m[39m[90m 172 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/games'[39m))[33m;[39m
     [90m     |[39m                                               [31m[1m^[22m[39m
     [90m 173 |[39m
     [90m 174 |[39m       [36mconst[39m gameSelect [33m=[39m screen[33m.[39mgetByLabelText([35m/Gioco:/i[39m)[33m;[39m
     [90m 175 |[39m       expect(within(gameSelect)[33m.[39mgetByText([32m'Chess'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:172:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Data Loading › auto-selects first game when games are loaded

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/games"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 182 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 183 |[39m
    [31m[1m>[22m[39m[90m 184 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/games'[39m))[33m;[39m
     [90m     |[39m                                               [31m[1m^[22m[39m
     [90m 185 |[39m
     [90m 186 |[39m       [36mconst[39m gameSelect [33m=[39m screen[33m.[39mgetByLabelText([35m/Gioco:/i[39m) [36mas[39m [33mHTMLSelectElement[39m[33m;[39m
     [90m 187 |[39m       expect(gameSelect[33m.[39mvalue)[33m.[39mtoBe([32m'game-1'[39m)[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:184:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Data Loading › shows loading indicator while loading games

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 234 |[39m
     [90m 235 |[39m       [36mconst[39m gameSelect [33m=[39m screen[33m.[39mgetByLabelText([35m/Gioco:/i[39m) [36mas[39m [33mHTMLSelectElement[39m[33m;[39m
    [31m[1m>[22m[39m[90m 236 |[39m       expect(gameSelect[33m.[39mdisabled)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                                   [31m[1m^[22m[39m
     [90m 237 |[39m     })[33m;[39m
     [90m 238 |[39m
     [90m 239 |[39m     it([32m'shows loading indicator while loading chats'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.toBe (src/pages/__tests__/chat.test.tsx:236:35)

  ● ChatPage › Data Loading › shows empty state when no games are available

    TypeError: games.map is not a function

    [0m [90m 549 |[39m             [33m>[39m
     [90m 550 |[39m               [33m<[39m[33moption[39m value[33m=[39m[32m""[39m[33m>[39m[33mSeleziona[39m un gioco[33m...[39m[33m<[39m[33m/[39m[33moption[39m[33m>[39m
    [31m[1m>[22m[39m[90m 551 |[39m               {games[33m.[39mmap((game) [33m=>[39m (
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 552 |[39m                 [33m<[39m[33moption[39m key[33m=[39m{game[33m.[39mid} value[33m=[39m{game[33m.[39mid}[33m>[39m
     [90m 553 |[39m                   {game[33m.[39mname}
     [90m 554 |[39m                 [33m<[39m[33m/[39m[33moption[39m[33m>[39m[0m

      at map (src/pages/chat.tsx:551:22)
      at renderWithHooks (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at updateFunctionComponent (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:19617:20)
      at beginWork (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:21640:16)
      at beginWork$1 (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at workLoop (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:266:34)
      at flushWork (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:239:14)
      at performWorkUntilDeadline (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:533:21)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Data Loading › shows empty state when no games are available

    TestingLibraryElementError: Unable to find a label with the text of: /Gioco:/i

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div />[39m
    [36m</body>[39m

    [0m [90m 258 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/games'[39m))[33m;[39m
     [90m 259 |[39m
    [31m[1m>[22m[39m[90m 260 |[39m       [36mconst[39m gameSelect [33m=[39m screen[33m.[39mgetByLabelText([35m/Gioco:/i[39m)[33m;[39m
     [90m     |[39m                                 [31m[1m^[22m[39m
     [90m 261 |[39m       expect(within(gameSelect)[33m.[39mgetByText([35m/Seleziona un gioco.../i[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 262 |[39m       expect(within(gameSelect)[33m.[39mqueryByText([32m'Chess'[39m))[33m.[39mnot[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 263 |[39m     })[33m;[39m[0m

      at Object.getElementError (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:37:19)
      at getAllByLabelText (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/queries/label-text.js:111:38)
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByLabelText (src/pages/__tests__/chat.test.tsx:260:33)

  ● ChatPage › Data Loading › shows empty state when no chats exist

    Unable to find an element with the text: /Nessuna chat. Creane una nuova!/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
        [36m>[39m
          [36m<a[39m
            [33mhref[39m=[32m"/"[39m
            [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
          [36m>[39m
            [0m← Torna alla Home[0m
          [36m</a>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
          [36m>[39m
            [36m<h2>[39m
              [0mAccesso richiesto[0m
            [36m</h2>[39m
            [36m<p>[39m
              [0mDevi effettuare l'accesso per utilizzare la chat.[0m
            [36m</p>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
            [36m>[39m
              [0mVai al Login[0m
            [36m</a>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 271 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 272 |[39m
    [31m[1m>[22m[39m[90m 273 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 274 |[39m         expect(screen[33m.[39mgetByText([35m/Nessuna chat. Creane una nuova!/i[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 275 |[39m       })[33m;[39m
     [90m 276 |[39m     })[33m;[39m[0m

      at waitForWrapper (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/pages/__tests__/chat.test.tsx:273:20)

  ● ChatPage › Data Loading › handles games loading error gracefully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/games"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 283 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 284 |[39m
    [31m[1m>[22m[39m[90m 285 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/games'[39m))[33m;[39m
     [90m     |[39m                                               [31m[1m^[22m[39m
     [90m 286 |[39m
     [90m 287 |[39m       expect(screen[33m.[39mgetByText([35m/Errore nel caricamento dei giochi/i[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 288 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:285:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Data Loading › handles agents loading error gracefully

    Unable to find an element with the text: /Errore nel caricamento degli agenti/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
        [36m>[39m
          [36m<aside[39m
            [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
            [36m>[39m
              [36m<h2[39m
                [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
              [36m>[39m
                [0mMeepleAI Chat[0m
              [36m</h2>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mGioco:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un gioco...[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mAgente:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mdisabled[39m=[32m""[39m
                  [33mid[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un agente...[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"width: 100%; padding: 10px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
              [36m>[39m
                [0m+ Nuova Chat[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 16px; text-align: center; color: rgb(95, 99, 104); font-size: 13px;"[39m
              [36m>[39m
                [0mNessuna chat. Creane una nuova![0m
              [36m</div>[39m
            [36m</div>[39m
          [36m</aside>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
              [36m>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                  [33mtitle[39m=[32m"Nascondi sidebar"[39m
                [36m>[39m
                  [0m✕[0m
                [36m</button>[39m
                [36m<div>[39m
                  [36m<h1[39m
                    [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                  [36m>[39m
                    [0mSeleziona o crea una chat[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                  [36m>[39m
                    [0mNessun gioco selezionato[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mHome[0m
              [36m</a>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"text-align: center; padding: 48px; color: rgb(95, 99, 104);"[39m
              [36m>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 16px; margin-bottom: 8px;"[39m
                [36m>[39m
                  [0mNessun messaggio ancora.[0m
                [36m</p>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 14px;"[39m
                [36m>[39m
                  [0mSeleziona una chat esistente o creane una nuova per iniziare.[0m
                [36m</p>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<form[39m
              [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
            [36m>[39m
              [36m<input[39m
                [33mdisabled[39m=[32m""[39m
                [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                [33mtype[39m=[32m"text"[39m
                [33mvalue[39m=[32m""[39m
              [36m/>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                [33mtype[39m=[32m"submit"[39m
              [36m>[39m
                [0mInvia[0m
              [36m</button>[39m
            [36m</form>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 299 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 300 |[39m
    [31m[1m>[22m[39m[90m 301 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                    [31m[1m^[22m[39m
     [90m 302 |[39m         expect(screen[33m.[39mgetByText([35m/Errore nel caricamento degli agenti/i[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 303 |[39m       })[33m;[39m
     [90m 304 |[39m[0m

      at waitForWrapper (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/pages/__tests__/chat.test.tsx:301:20)

  ● ChatPage › Game and Agent Selection › allows changing game selection

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/games"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 336 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 337 |[39m
    [31m[1m>[22m[39m[90m 338 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/games'[39m))[33m;[39m
     [90m     |[39m                                               [31m[1m^[22m[39m
     [90m 339 |[39m
     [90m 340 |[39m       [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 341 |[39m       [36mconst[39m gameSelect [33m=[39m screen[33m.[39mgetByLabelText([35m/Gioco:/i[39m)[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:338:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Game and Agent Selection › reloads agents when game changes

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/games/game-1/agents"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 359 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 360 |[39m
    [31m[1m>[22m[39m[90m 361 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/games/game-1/agents'[39m))[33m;[39m
     [90m     |[39m                                               [31m[1m^[22m[39m
     [90m 362 |[39m
     [90m 363 |[39m       [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 364 |[39m       [36mconst[39m gameSelect [33m=[39m screen[33m.[39mgetByLabelText([35m/Gioco:/i[39m)[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:361:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Game and Agent Selection › clears active chat when game changes

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received
           1: "/auth/me"
           2: "/games"

    Number of calls: 2

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
          [36m>[39m
            [36m<aside[39m
              [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
              [36m>[39m
                [36m<h2[39m
                  [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
                [36m>[39m
                  [0mMeepleAI Chat[0m
                [36m</h2>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mfor[39m=[32m"gameSelect"[39m
                    [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                  [36m>[39m
                    [0mGioco:[0m
                  [36m</label>[39m
                  [36m<select[39m
                    [33mid[39m=[32m"gameSelect"[39m
                    [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                  [36m>[39m
                    [36m<option[39m
                      [33mvalue[39m=[32m""[39m
                    [36m>[39m
                      [0mSeleziona un gioco...[0m
                    [36m</option>[39m
                  [36m</select>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mfor[39m=[32m"agentSelect"[39m
                    [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                  [36m>[39m
                    [0mAgente:[0m
                  [36m</label>[39m
                  [36m<select[39m
                    [33mdisabled[39m=[32m""[39m
                    [33mid[39m=[32m"agentSelect"[39m
                    [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                  [36m>[39m
                    [36m<option[39m
                      [33mvalue[39m=[32m""[39m
                    [36m>[39m
                      [0mSeleziona un agente...[0m
                    [36m</option>[39m
                  [36m</select>[39m
                [36m</div>[39m
                [36m<button[39m
                  [33mdisabled[39m=[32m""[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 10px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                [36m>[39m
                  [0m+ Nuova Chat[0m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"padding: 16px; text-align: center; color: rgb(95, 99, 104); font-size: 13px;"[39m
                [36m>[39m
                  [0mNessuna chat. Creane una nuova![0m
                [36m</div>[39m
              [36m</div>[39m
            [36m</aside>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
                [36m>[39m
                  [36m<button[39m
                    [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                    [33mtitle[39m=[32m"Nascondi sidebar"[39m
                  [36m>[39m
                    [0m✕[0m
                  [36m</button>[39m
                  [36m<div>[39m
                    [36m<h1[39m
                      [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                    [36m>[39m
                      [0mSeleziona o crea una chat[0m
                    [36m</h1>[39m
                    [36m<p[39m
                      [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                    [36m>[39m
                      [0mNessun gioco selezionato[0m
                    [36m</p>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<a[39m
                  [33mhref[39m=[32m"/"[39m
                  [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
                [36m>[39m
                  [0mHome[0m
                [36m</a>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin: 16px; padding: 12px; background: rgb(252, 232, 230); color: rgb(217, 48, 37); border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mErrore nel caricamento dei giochi.[0m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"text-align: center; padding: 48px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"font-size: 16px; margin-bottom: 8px;"[39m
                  [36m>[39m
                    [0mNessun messaggio ancora.[0m
                  [36m</p>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"font-size: 14px;"[39m
                  [36m>[39m
                    [0mSeleziona una chat esistente o creane una nuova per iniziare.[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<form[39m
                [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
              [36m>[39m
                [36m<input[39m
                  [33mdisabled[39m=[32m""[39m
                  [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                  [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                  [33mtype[39m=[32m"text"[39m
                  [33mvalue[39m=[32m""[39m
                [36m/>[39m
                [36m<button[39m
                  [33mdisabled[39m=[32m""[39m
                  [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                  [33mtype[39m=[32m"submit"[39m
                [36m>[39m
                  [0mInvia[0m
                [36m</button>[39m
              [36m</form>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 382 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 383 |[39m
    [31m[1m>[22m[39m[90m 384 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m     |[39m                                               [31m[1m^[22m[39m
     [90m 385 |[39m
     [90m 386 |[39m       [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 387 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:384:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Game and Agent Selection › allows changing agent selection

    TestingLibraryElementError: Value "agent-2" not found in options

    Ignored nodes: comments, script, style
    [36m<select[39m
      [33mid[39m=[32m"agentSelect"[39m
      [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
    [36m>[39m
      [36m<option[39m
        [33mvalue[39m=[32m""[39m
      [36m>[39m
        [0mSeleziona un agente...[0m
      [36m</option>[39m
    [36m</select>[39m

    [0m [90m 417 |[39m       [36mconst[39m agentSelect [33m=[39m screen[33m.[39mgetByLabelText([35m/Agente:/i[39m) [36mas[39m [33mHTMLSelectElement[39m[33m;[39m
     [90m 418 |[39m
    [31m[1m>[22m[39m[90m 419 |[39m       [36mawait[39m user[33m.[39mselectOptions(agentSelect[33m,[39m [32m'agent-2'[39m)[33m;[39m
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 420 |[39m
     [90m 421 |[39m       expect(agentSelect[33m.[39mvalue)[33m.[39mtoBe([32m'agent-2'[39m)[33m;[39m
     [90m 422 |[39m     })[33m;[39m[0m

      at Object.getElementError (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/.pnpm/@testing-library+user-event_1ca100c7362ccf0b1358603d616c282d/node_modules/@testing-library/user-event/dist/cjs/utility/selectOptions.js:39:39
          at Array.map (<anonymous>)
      at Object.selectOptionsBase (node_modules/.pnpm/@testing-library+user-event_1ca100c7362ccf0b1358603d616c282d/node_modules/@testing-library/user-event/dist/cjs/utility/selectOptions.js:31:38)
      at Object.selectOptions (node_modules/.pnpm/@testing-library+user-event_1ca100c7362ccf0b1358603d616c282d/node_modules/@testing-library/user-event/dist/cjs/utility/selectOptions.js:18:30)
      at node_modules/.pnpm/@testing-library+user-event_1ca100c7362ccf0b1358603d616c282d/node_modules/@testing-library/user-event/dist/cjs/setup/setup.js:85:45
      at Object.asyncWrapper (node_modules/.pnpm/@testing-library+react@16.3_fb6f624c3a2f22b5d281a485df5b4749/node_modules/@testing-library/react/dist/pure.js:88:28)
      at Object.wrapAsync (node_modules/.pnpm/@testing-library+user-event_1ca100c7362ccf0b1358603d616c282d/node_modules/@testing-library/user-event/dist/cjs/setup/wrapAsync.js:8:28)
      at Object.method [as selectOptions] (node_modules/.pnpm/@testing-library+user-event_1ca100c7362ccf0b1358603d616c282d/node_modules/@testing-library/user-event/dist/cjs/setup/setup.js:85:26)
      at Object.selectOptions (src/pages/__tests__/chat.test.tsx:419:18)

  ● ChatPage › Chat Management › Loading Existing Chat › loads chat history when chat is clicked

    TestingLibraryElementError: Unable to find an element with the text: How do I castle?. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
        [36m>[39m
          [36m<aside[39m
            [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
            [36m>[39m
              [36m<h2[39m
                [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
              [36m>[39m
                [0mMeepleAI Chat[0m
              [36m</h2>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mGioco:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un gioco...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-1"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-2"[39m
                  [36m>[39m
                    [0mCatan[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mAgente:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un agente...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-1"[39m
                  [36m>[39m
                    [0mChess Expert[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-2"[39m
                  [36m>[39m
                    [0mChess Helper[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<button[39m
                [33mstyle[39m=[32m"width: 100%; padding: 10px; color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; background: rgb(26, 115, 232);"[39m
              [36m>[39m
                [0m+ Nuova Chat[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Expert[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Expert - 10/01/2025 11:05:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Helper[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Helper - 09/01/2025 15:00:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</aside>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
              [36m>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                  [33mtitle[39m=[32m"Nascondi sidebar"[39m
                [36m>[39m
                  [0m✕[0m
                [36m</button>[39m
                [36m<div>[39m
                  [36m<h1[39m
                    [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                  [36m>[39m
                    [0mSeleziona o crea una chat[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mHome[0m
              [36m</a>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin: 16px; padding: 12px; background: rgb(252, 232, 230); color: rgb(217, 48, 37); border-radius: 4px; font-size: 14px;"[39m
            [36m>[39m
              [0mErrore nel caricamento della cronologia chat.[0m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"text-align: center; padding: 48px; color: rgb(95, 99, 104);"[39m
              [36m>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 16px; margin-bottom: 8px;"[39m
                [36m>[39m
                  [0mNessun messaggio ancora.[0m
                [36m</p>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 14px;"[39m
                [36m>[39m
                  [0mSeleziona una chat esistente o creane una nuova per iniziare.[0m
                [36m</p>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<form[39m
              [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
            [36m>[39m
              [36m<input[39m
                [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                [33mtype[39m=[32m"text"[39m
                [33mvalue[39m=[32m""[39m
              [36m/>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                [33mtype[39m=[32m"submit"[39m
              [36m>[39m
                [0mInvia[0m
              [36m</button>[39m
            [36m</form>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 581 |[39m         })[33m;[39m
     [90m 582 |[39m
    [31m[1m>[22m[39m[90m 583 |[39m         expect(screen[33m.[39mgetByText([32m'How do I castle?'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m     |[39m                       [31m[1m^[22m[39m
     [90m 584 |[39m         expect(screen[33m.[39mgetByText([32m'Castling is a special move...'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 585 |[39m       })[33m;[39m
     [90m 586 |[39m[0m

      at Object.getElementError (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByText (src/pages/__tests__/chat.test.tsx:583:23)

  ● ChatPage › Chat Management › Loading Existing Chat › shows loading indicator while loading chat history

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 590 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 591 |[39m
    [31m[1m>[22m[39m[90m 592 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m     |[39m                                                 [31m[1m^[22m[39m
     [90m 593 |[39m
     [90m 594 |[39m         mockApi[33m.[39m[36mget[39m[33m.[39mmockImplementation(() [33m=>[39m [36mnew[39m [33mPromise[39m(() [33m=>[39m {}))[33m;[39m [90m// Never resolves[39m
     [90m 595 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:592:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Chat Management › Loading Existing Chat › converts backend messages to frontend format correctly

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 609 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 610 |[39m
    [31m[1m>[22m[39m[90m 611 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m     |[39m                                                 [31m[1m^[22m[39m
     [90m 612 |[39m
     [90m 613 |[39m         [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 614 |[39m         [36mconst[39m chatItems [33m=[39m screen[33m.[39mgetAllByText([32m'Chess Expert'[39m)[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:611:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Chat Management › Loading Existing Chat › handles malformed metadata JSON gracefully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 646 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 647 |[39m
    [31m[1m>[22m[39m[90m 648 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m     |[39m                                                 [31m[1m^[22m[39m
     [90m 649 |[39m
     [90m 650 |[39m         [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 651 |[39m         [36mconst[39m chatItems [33m=[39m screen[33m.[39mgetAllByText([32m'Chess Expert'[39m)[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:648:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Chat Management › Loading Existing Chat › synchronizes game and agent selection with loaded chat

    TypeError: agents.map is not a function

    [0m [90m 580 |[39m             [33m>[39m
     [90m 581 |[39m               [33m<[39m[33moption[39m value[33m=[39m[32m""[39m[33m>[39m[33mSeleziona[39m un agente[33m...[39m[33m<[39m[33m/[39m[33moption[39m[33m>[39m
    [31m[1m>[22m[39m[90m 582 |[39m               {agents[33m.[39mmap((agent) [33m=>[39m (
     [90m     |[39m                       [31m[1m^[22m[39m
     [90m 583 |[39m                 [33m<[39m[33moption[39m key[33m=[39m{agent[33m.[39mid} value[33m=[39m{agent[33m.[39mid}[33m>[39m
     [90m 584 |[39m                   {agent[33m.[39mname}
     [90m 585 |[39m                 [33m<[39m[33m/[39m[33moption[39m[33m>[39m[0m

      at map (src/pages/chat.tsx:582:23)
      at renderWithHooks (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at updateFunctionComponent (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:19617:20)
      at beginWork (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:21640:16)
      at beginWork$1 (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at recoverFromConcurrentError (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:25889:20)
      at performConcurrentWorkOnRoot (node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/cjs/react-dom.development.js:25789:22)
      at workLoop (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:266:34)
      at flushWork (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:239:14)
      at performWorkUntilDeadline (node_modules/.pnpm/scheduler@0.23.2/node_modules/scheduler/cjs/scheduler.development.js:533:21)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Chat Management › Loading Existing Chat › synchronizes game and agent selection with loaded chat

    TestingLibraryElementError: Unable to find an element with the text: Chess Expert. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div />[39m
    [36m</body>[39m

    [0m [90m 680 |[39m         [90m// Load chat that has different game/agent[39m
     [90m 681 |[39m         mockApi[33m.[39m[36mget[39m[33m.[39mmockResolvedValueOnce(mockChatWithHistory)[33m;[39m
    [31m[1m>[22m[39m[90m 682 |[39m         [36mconst[39m chatItems [33m=[39m screen[33m.[39mgetAllByText([32m'Chess Expert'[39m)[33m;[39m
     [90m     |[39m                                  [31m[1m^[22m[39m
     [90m 683 |[39m         [36mawait[39m user[33m.[39mclick(chatItems[chatItems[33m.[39mlength [33m-[39m [35m1[39m])[33m;[39m
     [90m 684 |[39m
     [90m 685 |[39m         [36mawait[39m waitFor(() [33m=>[39m {[0m

      at Object.getElementError (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:109:15
      at Object.getAllByText (src/pages/__tests__/chat.test.tsx:682:34)

  ● ChatPage › Chat Management › Loading Existing Chat › handles chat history loading error gracefully

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 699 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 700 |[39m
    [31m[1m>[22m[39m[90m 701 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m     |[39m                                                 [31m[1m^[22m[39m
     [90m 702 |[39m
     [90m 703 |[39m         [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 704 |[39m         [36mconst[39m chatItems [33m=[39m screen[33m.[39mgetAllByText([32m'Chess Expert'[39m)[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:701:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Chat Management › Deleting Chat › deletes chat when delete button is clicked and confirmed

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 722 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 723 |[39m
    [31m[1m>[22m[39m[90m 724 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m     |[39m                                                 [31m[1m^[22m[39m
     [90m 725 |[39m
     [90m 726 |[39m         [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 727 |[39m         [36mconst[39m deleteButtons [33m=[39m screen[33m.[39mgetAllByTitle([32m'Elimina chat'[39m)[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:724:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Chat Management › Deleting Chat › handles chat deletion error gracefully

    Unable to find an element with the text: /Errore nell'eliminazione della chat/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
        [36m>[39m
          [36m<aside[39m
            [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
            [36m>[39m
              [36m<h2[39m
                [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
              [36m>[39m
                [0mMeepleAI Chat[0m
              [36m</h2>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mGioco:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un gioco...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-1"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-2"[39m
                  [36m>[39m
                    [0mCatan[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mAgente:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un agente...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-1"[39m
                  [36m>[39m
                    [0mChess Expert[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-2"[39m
                  [36m>[39m
                    [0mChess Helper[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<button[39m
                [33mstyle[39m=[32m"width: 100%; padding: 10px; color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; background: rgb(26, 115, 232);"[39m
              [36m>[39m
                [0m+ Nuova Chat[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Helper[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Helper - 09/01/2025 15:00:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</aside>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
              [36m>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                  [33mtitle[39m=[32m"Nascondi sidebar"[39m
                [36m>[39m
                  [0m✕[0m
                [36m</button>[39m
                [36m<div>[39m
                  [36m<h1[39m
                    [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                  [36m>[39m
                    [0mSeleziona o crea una chat[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mHome[0m
              [36m</a>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"text-align: center; padding: 48px; color: rgb(95, 99, 104);"[39m
              [36m>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 16px; margin-bottom: 8px;"[39m
                [36m>[39m
                  [0mNessun messaggio ancora.[0m
                [36m</p>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 14px;"[39m
                [36m>[39m
                  [0mSeleziona una chat esistente o creane una nuova per iniziare.[0m
                [36m</p>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<form[39m
              [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
            [36m>[39m
              [36m<input[39m
                [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                [33mtype[39m=[32m"text"[39m
                [33mvalue[39m=[32m""[39m
              [36m/>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                [33mtype[39m=[32m"submit"[39m
              [36m>[39m
                [0mInvia[0m
              [36m</button>[39m
            [36m</form>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 811 |[39m         [36mawait[39m user[33m.[39mclick(deleteButtons[[35m0[39m])[33m;[39m
     [90m 812 |[39m
    [31m[1m>[22m[39m[90m 813 |[39m         [36mawait[39m waitFor(() [33m=>[39m {
     [90m     |[39m                      [31m[1m^[22m[39m
     [90m 814 |[39m           expect(screen[33m.[39mgetByText([35m/Errore nell'eliminazione della chat/i[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 815 |[39m         })[33m;[39m
     [90m 816 |[39m[0m

      at waitForWrapper (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/pages/__tests__/chat.test.tsx:813:22)

  ● ChatPage › Messaging › Sending Messages › sends message with chatId when chat is active

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 853 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 854 |[39m
    [31m[1m>[22m[39m[90m 855 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m     |[39m                                                 [31m[1m^[22m[39m
     [90m 856 |[39m
     [90m 857 |[39m         [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 858 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:855:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Messaging › Sending Messages › displays user message immediately and assistant response after API call

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 944 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 945 |[39m
    [31m[1m>[22m[39m[90m 946 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m     |[39m                                                 [31m[1m^[22m[39m
     [90m 947 |[39m
     [90m 948 |[39m         [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 949 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:946:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Messaging › Sending Messages › shows loading indicator while sending message

    Unable to find an element with the text: How do I castle?. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
        [36m>[39m
          [36m<aside[39m
            [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
            [36m>[39m
              [36m<h2[39m
                [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
              [36m>[39m
                [0mMeepleAI Chat[0m
              [36m</h2>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mGioco:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un gioco...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-1"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-2"[39m
                  [36m>[39m
                    [0mCatan[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mAgente:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un agente...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-1"[39m
                  [36m>[39m
                    [0mChess Expert[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-2"[39m
                  [36m>[39m
                    [0mChess Helper[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<button[39m
                [33mstyle[39m=[32m"width: 100%; padding: 10px; color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; background: rgb(26, 115, 232);"[39m
              [36m>[39m
                [0m+ Nuova Chat[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Expert[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Expert - 10/01/2025 11:05:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Helper[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Helper - 09/01/2025 15:00:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</aside>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
              [36m>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                  [33mtitle[39m=[32m"Nascondi sidebar"[39m
                [36m>[39m
                  [0m✕[0m
                [36m</button>[39m
                [36m<div>[39m
                  [36m<h1[39m
                    [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                  [36m>[39m
                    [0mSeleziona o crea una chat[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mHome[0m
              [36m</a>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin: 16px; padding: 12px; background: rgb(252, 232, 230); color: rgb(217, 48, 37); border-radius: 4px; font-size: 14px;"[39m
            [36m>[39m
              [0mErrore nel caricamento della cronologia chat.[0m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"text-align: center; padding: 48px; color: rgb(95, 99, 104);"[39m
              [36m>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 16px; margin-bottom: 8px;"[39m
                [36m>[39m
                  [0mNessun messaggio ancora.[0m
                [36m</p>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 14px;"[39m
                [36m>[39m
                  [0mSeleziona una chat esistente o creane una nuova per iniziare.[0m
                [36m</p>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<form[39m
              [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
            [36m>[39m
              [36m<input[39m
                [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                [33mtype[39m=[32m"text"[39m
                [33mvalue[39m=[32m""[39m
              [36m/>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                [33mtype[39m=[32m"submit"[39m
              [36m>[39m
                [0mInvia[0m
              [36m</button>[39m
            [36m</form>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 1027 |[39m         [36mawait[39m user[33m.[39mclick(chatItems[chatItems[33m.[39mlength [33m-[39m [35m1[39m])[33m;[39m
     [90m 1028 |[39m
    [31m[1m>[22m[39m[90m 1029 |[39m         [36mawait[39m waitFor(() [33m=>[39m {
     [90m      |[39m                      [31m[1m^[22m[39m
     [90m 1030 |[39m           expect(screen[33m.[39mgetByText([32m'How do I castle?'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 1031 |[39m         })[33m;[39m
     [90m 1032 |[39m[0m

      at waitForWrapper (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/pages/__tests__/chat.test.tsx:1029:22)

  ● ChatPage › Messaging › Sending Messages › disables send button when input contains only whitespace

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1097 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1098 |[39m
    [31m[1m>[22m[39m[90m 1099 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                                 [31m[1m^[22m[39m
     [90m 1100 |[39m
     [90m 1101 |[39m         [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 1102 |[39m         [36mconst[39m input [33m=[39m screen[33m.[39mgetByPlaceholderText([35m/Fai una domanda sul gioco/i[39m)[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1099:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Messaging › Sending Messages › removes user message when message sending fails

    Unable to find an element with the text: How do I castle?. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
        [36m>[39m
          [36m<aside[39m
            [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
            [36m>[39m
              [36m<h2[39m
                [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
              [36m>[39m
                [0mMeepleAI Chat[0m
              [36m</h2>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mGioco:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un gioco...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-1"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-2"[39m
                  [36m>[39m
                    [0mCatan[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mAgente:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un agente...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-1"[39m
                  [36m>[39m
                    [0mChess Expert[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-2"[39m
                  [36m>[39m
                    [0mChess Helper[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<button[39m
                [33mstyle[39m=[32m"width: 100%; padding: 10px; color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; background: rgb(26, 115, 232);"[39m
              [36m>[39m
                [0m+ Nuova Chat[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Expert[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Expert - 10/01/2025 11:05:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Helper[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Helper - 09/01/2025 15:00:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</aside>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
              [36m>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                  [33mtitle[39m=[32m"Nascondi sidebar"[39m
                [36m>[39m
                  [0m✕[0m
                [36m</button>[39m
                [36m<div>[39m
                  [36m<h1[39m
                    [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                  [36m>[39m
                    [0mSeleziona o crea una chat[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mHome[0m
              [36m</a>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin: 16px; padding: 12px; background: rgb(252, 232, 230); color: rgb(217, 48, 37); border-radius: 4px; font-size: 14px;"[39m
            [36m>[39m
              [0mErrore nel caricamento della cronologia chat.[0m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"text-align: center; padding: 48px; color: rgb(95, 99, 104);"[39m
              [36m>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 16px; margin-bottom: 8px;"[39m
                [36m>[39m
                  [0mNessun messaggio ancora.[0m
                [36m</p>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 14px;"[39m
                [36m>[39m
                  [0mSeleziona una chat esistente o creane una nuova per iniziare.[0m
                [36m</p>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<form[39m
              [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
            [36m>[39m
              [36m<input[39m
                [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                [33mtype[39m=[32m"text"[39m
                [33mvalue[39m=[32m""[39m
              [36m/>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                [33mtype[39m=[32m"submit"[39m
              [36m>[39m
                [0mInvia[0m
              [36m</button>[39m
            [36m</form>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 1141 |[39m         [36mawait[39m user[33m.[39mclick(chatItems[chatItems[33m.[39mlength [33m-[39m [35m1[39m])[33m;[39m
     [90m 1142 |[39m
    [31m[1m>[22m[39m[90m 1143 |[39m         [36mawait[39m waitFor(() [33m=>[39m {
     [90m      |[39m                      [31m[1m^[22m[39m
     [90m 1144 |[39m           expect(screen[33m.[39mgetByText([32m'How do I castle?'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 1145 |[39m         })[33m;[39m
     [90m 1146 |[39m[0m

      at waitForWrapper (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/pages/__tests__/chat.test.tsx:1143:22)

  ● ChatPage › Messaging › Sending Messages › handles auto-creation failure when sending first message

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1175 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1176 |[39m
    [31m[1m>[22m[39m[90m 1177 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                                 [31m[1m^[22m[39m
     [90m 1178 |[39m
     [90m 1179 |[39m         [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 1180 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1177:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Messaging › Sending Messages › updates chat lastMessageAt timestamp after sending message

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1203 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1204 |[39m
    [31m[1m>[22m[39m[90m 1205 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                                 [31m[1m^[22m[39m
     [90m 1206 |[39m
     [90m 1207 |[39m         [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 1208 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1205:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Messaging › Displaying Messages › displays snippets with page numbers

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1243 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1244 |[39m
    [31m[1m>[22m[39m[90m 1245 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                                 [31m[1m^[22m[39m
     [90m 1246 |[39m
     [90m 1247 |[39m         [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 1248 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1245:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Messaging › Displaying Messages › displays snippets without page numbers when page is null

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1282 |[39m         render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1283 |[39m
    [31m[1m>[22m[39m[90m 1284 |[39m         [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                                 [31m[1m^[22m[39m
     [90m 1285 |[39m
     [90m 1286 |[39m         [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 1287 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1284:49)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Messaging › Displaying Messages › does not display snippets section when no snippets exist

    Unable to find an element with the text: Simple answer. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
        [36m>[39m
          [36m<aside[39m
            [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
            [36m>[39m
              [36m<h2[39m
                [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
              [36m>[39m
                [0mMeepleAI Chat[0m
              [36m</h2>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mGioco:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un gioco...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-1"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-2"[39m
                  [36m>[39m
                    [0mCatan[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mAgente:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un agente...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-1"[39m
                  [36m>[39m
                    [0mChess Expert[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-2"[39m
                  [36m>[39m
                    [0mChess Helper[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<button[39m
                [33mstyle[39m=[32m"width: 100%; padding: 10px; color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; background: rgb(26, 115, 232);"[39m
              [36m>[39m
                [0m+ Nuova Chat[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; font-size: 13px; margin-bottom: 8px; background: rgb(232, 240, 254); border: 1px solid rgb(26, 115, 232); border-radius: 4px; cursor: pointer; position: relative;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m/>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mundefined - Invalid Date Invalid Date[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</aside>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
              [36m>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                  [33mtitle[39m=[32m"Nascondi sidebar"[39m
                [36m>[39m
                  [0m✕[0m
                [36m</button>[39m
                [36m<div>[39m
                  [36m<h1[39m
                    [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                  [36m>[39m
                    [0mSeleziona o crea una chat[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mHome[0m
              [36m</a>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 24px; display: flex; flex-direction: column; align-items: flex-end;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"max-width: 75%; padding: 12px; border-radius: 8px; background: rgb(227, 242, 253); font-size: 14px; line-height: 1.5;"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px; font-size: 12px; color: rgb(95, 99, 104);"[39m
                  [36m>[39m
                    [0mTu[0m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mstyle[39m=[32m"white-space: pre-wrap;"[39m
                  [36m>[39m
                    [0mSimple question[0m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(154, 160, 166); margin-top: 4px;"[39m
                [36m>[39m
                  [0m21:51:03[0m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: flex-start; margin-bottom: 24px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"max-width: 75%; padding: 12px; border-radius: 8px; background: rgb(241, 243, 244); font-size: 14px;"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px; font-size: 12px; color: rgb(95, 99, 104);"[39m
                  [36m>[39m
                    [0mMeepleAI[0m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mstyle[39m=[32m"color: rgb(95, 99, 104);"[39m
                  [36m>[39m
                    [0mSto pensando...[0m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<form[39m
              [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
            [36m>[39m
              [36m<input[39m
                [33mdisabled[39m=[32m""[39m
                [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                [33mtype[39m=[32m"text"[39m
                [33mvalue[39m=[32m""[39m
              [36m/>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"padding: 12px 24px; color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed; background: rgb(218, 220, 224);"[39m
                [33mtype[39m=[32m"submit"[39m
              [36m>[39m
                [0mInvio...[0m
              [36m</button>[39m
            [36m</form>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 1352 |[39m         [36mawait[39m user[33m.[39mclick(sendButton)[33m;[39m
     [90m 1353 |[39m
    [31m[1m>[22m[39m[90m 1354 |[39m         [36mawait[39m waitFor(() [33m=>[39m {
     [90m      |[39m                      [31m[1m^[22m[39m
     [90m 1355 |[39m           expect(screen[33m.[39mgetByText([32m'Simple answer'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 1356 |[39m         })[33m;[39m
     [90m 1357 |[39m[0m

      at waitForWrapper (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/pages/__tests__/chat.test.tsx:1354:22)

  ● ChatPage › Feedback › toggles feedback to null when clicking same button twice

    Unable to find an element with the text: Castling is a special move.... This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
        [36m>[39m
          [36m<aside[39m
            [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
            [36m>[39m
              [36m<h2[39m
                [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
              [36m>[39m
                [0mMeepleAI Chat[0m
              [36m</h2>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mGioco:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un gioco...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-1"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-2"[39m
                  [36m>[39m
                    [0mCatan[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mAgente:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un agente...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-1"[39m
                  [36m>[39m
                    [0mChess Expert[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-2"[39m
                  [36m>[39m
                    [0mChess Helper[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<button[39m
                [33mstyle[39m=[32m"width: 100%; padding: 10px; color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; background: rgb(26, 115, 232);"[39m
              [36m>[39m
                [0m+ Nuova Chat[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Expert[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Expert - 10/01/2025 11:05:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Helper[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Helper - 09/01/2025 15:00:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</aside>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
              [36m>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                  [33mtitle[39m=[32m"Nascondi sidebar"[39m
                [36m>[39m
                  [0m✕[0m
                [36m</button>[39m
                [36m<div>[39m
                  [36m<h1[39m
                    [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                  [36m>[39m
                    [0mSeleziona o crea una chat[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mHome[0m
              [36m</a>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin: 16px; padding: 12px; background: rgb(252, 232, 230); color: rgb(217, 48, 37); border-radius: 4px; font-size: 14px;"[39m
            [36m>[39m
              [0mErrore nel caricamento della cronologia chat.[0m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"text-align: center; padding: 48px; color: rgb(95, 99, 104);"[39m
              [36m>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 16px; margin-bottom: 8px;"[39m
                [36m>[39m
                  [0mNessun messaggio ancora.[0m
                [36m</p>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 14px;"[39m
                [36m>[39m
                  [0mSeleziona una chat esistente o creane una nuova per iniziare.[0m
                [36m</p>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<form[39m
              [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
            [36m>[39m
              [36m<input[39m
                [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                [33mtype[39m=[32m"text"[39m
                [33mvalue[39m=[32m""[39m
              [36m/>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                [33mtype[39m=[32m"submit"[39m
              [36m>[39m
                [0mInvia[0m
              [36m</button>[39m
            [36m</form>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 1471 |[39m       [36mawait[39m user[33m.[39mclick(chatItems[chatItems[33m.[39mlength [33m-[39m [35m1[39m])[33m;[39m
     [90m 1472 |[39m
    [31m[1m>[22m[39m[90m 1473 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m      |[39m                    [31m[1m^[22m[39m
     [90m 1474 |[39m         expect(screen[33m.[39mgetByText([32m'Castling is a special move...'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 1475 |[39m       })[33m;[39m
     [90m 1476 |[39m[0m

      at waitForWrapper (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/pages/__tests__/chat.test.tsx:1473:20)

  ● ChatPage › Feedback › changes feedback when switching between helpful and not-helpful

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1513 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1514 |[39m
    [31m[1m>[22m[39m[90m 1515 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                               [31m[1m^[22m[39m
     [90m 1516 |[39m
     [90m 1517 |[39m       [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 1518 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1515:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Feedback › reverts feedback state when API call fails

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1557 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1558 |[39m
    [31m[1m>[22m[39m[90m 1559 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                               [31m[1m^[22m[39m
     [90m 1560 |[39m
     [90m 1561 |[39m       [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 1562 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1559:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Feedback › uses backend message ID for feedback when available

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1590 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1591 |[39m
    [31m[1m>[22m[39m[90m 1592 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                               [31m[1m^[22m[39m
     [90m 1593 |[39m
     [90m 1594 |[39m       [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 1595 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1592:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Feedback › only shows feedback buttons for assistant messages

    Unable to find an element with the text: How do I castle?. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
        [36m>[39m
          [36m<aside[39m
            [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
            [36m>[39m
              [36m<h2[39m
                [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
              [36m>[39m
                [0mMeepleAI Chat[0m
              [36m</h2>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mGioco:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un gioco...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-1"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-2"[39m
                  [36m>[39m
                    [0mCatan[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mAgente:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un agente...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-1"[39m
                  [36m>[39m
                    [0mChess Expert[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-2"[39m
                  [36m>[39m
                    [0mChess Helper[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<button[39m
                [33mstyle[39m=[32m"width: 100%; padding: 10px; color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; background: rgb(26, 115, 232);"[39m
              [36m>[39m
                [0m+ Nuova Chat[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Expert[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Expert - 10/01/2025 11:05:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Helper[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Helper - 09/01/2025 15:00:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</aside>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
              [36m>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                  [33mtitle[39m=[32m"Nascondi sidebar"[39m
                [36m>[39m
                  [0m✕[0m
                [36m</button>[39m
                [36m<div>[39m
                  [36m<h1[39m
                    [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                  [36m>[39m
                    [0mSeleziona o crea una chat[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mHome[0m
              [36m</a>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin: 16px; padding: 12px; background: rgb(252, 232, 230); color: rgb(217, 48, 37); border-radius: 4px; font-size: 14px;"[39m
            [36m>[39m
              [0mErrore nel caricamento della cronologia chat.[0m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"text-align: center; padding: 48px; color: rgb(95, 99, 104);"[39m
              [36m>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 16px; margin-bottom: 8px;"[39m
                [36m>[39m
                  [0mNessun messaggio ancora.[0m
                [36m</p>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 14px;"[39m
                [36m>[39m
                  [0mSeleziona una chat esistente o creane una nuova per iniziare.[0m
                [36m</p>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<form[39m
              [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
            [36m>[39m
              [36m<input[39m
                [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                [33mtype[39m=[32m"text"[39m
                [33mvalue[39m=[32m""[39m
              [36m/>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                [33mtype[39m=[32m"submit"[39m
              [36m>[39m
                [0mInvia[0m
              [36m</button>[39m
            [36m</form>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 1629 |[39m       [36mawait[39m user[33m.[39mclick(chatItems[chatItems[33m.[39mlength [33m-[39m [35m1[39m])[33m;[39m
     [90m 1630 |[39m
    [31m[1m>[22m[39m[90m 1631 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m      |[39m                    [31m[1m^[22m[39m
     [90m 1632 |[39m         expect(screen[33m.[39mgetByText([32m'How do I castle?'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 1633 |[39m       })[33m;[39m
     [90m 1634 |[39m[0m

      at waitForWrapper (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/pages/__tests__/chat.test.tsx:1631:20)

  ● ChatPage › UI Interactions › toggles sidebar when collapse button is clicked

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1653 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1654 |[39m
    [31m[1m>[22m[39m[90m 1655 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                               [31m[1m^[22m[39m
     [90m 1656 |[39m
     [90m 1657 |[39m       [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 1658 |[39m       [36mconst[39m collapseButton [33m=[39m screen[33m.[39mgetByTitle([35m/Nascondi sidebar/i[39m)[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1655:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › UI Interactions › shows game name in header when game is selected

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1669 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1670 |[39m
    [31m[1m>[22m[39m[90m 1671 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                               [31m[1m^[22m[39m
     [90m 1672 |[39m
     [90m 1673 |[39m       [90m// Use getAllByText since "Chess" appears in multiple places (header, select, chat items)[39m
     [90m 1674 |[39m       [36mconst[39m chessElements [33m=[39m screen[33m.[39mgetAllByText([32m'Chess'[39m)[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1671:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › UI Interactions › shows agent name in header when chat is active

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1682 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1683 |[39m
    [31m[1m>[22m[39m[90m 1684 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                               [31m[1m^[22m[39m
     [90m 1685 |[39m
     [90m 1686 |[39m       [36mconst[39m user [33m=[39m userEvent[33m.[39msetup()[33m;[39m
     [90m 1687 |[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1684:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › UI Interactions › highlights active chat in sidebar

    expect(element).toHaveStyle()

    - Expected
    + Received

    - background: rgb(232, 240, 254);

    [0m [90m 1729 |[39m
     [90m 1730 |[39m       [90m// First chat should have highlight styling[39m
    [31m[1m>[22m[39m[90m 1731 |[39m       expect(firstChat)[33m.[39mtoHaveStyle([32m'background: #e8f0fe'[39m)[33m;[39m
     [90m      |[39m                         [31m[1m^[22m[39m
     [90m 1732 |[39m     })[33m;[39m
     [90m 1733 |[39m
     [90m 1734 |[39m     it([32m'formats chat preview with date and time'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.toHaveStyle (src/pages/__tests__/chat.test.tsx:1731:25)

  ● ChatPage › UI Interactions › formats chat preview with date and time

    TestingLibraryElementError: Unable to find an element with the text: /\d{1,2}\/\d{1,2}\/\d{4}/. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
        [36m>[39m
          [36m<aside[39m
            [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
            [36m>[39m
              [36m<h2[39m
                [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
              [36m>[39m
                [0mMeepleAI Chat[0m
              [36m</h2>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mGioco:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un gioco...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-1"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-2"[39m
                  [36m>[39m
                    [0mCatan[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mAgente:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un agente...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-1"[39m
                  [36m>[39m
                    [0mChess Expert[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-2"[39m
                  [36m>[39m
                    [0mChess Helper[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<button[39m
                [33mstyle[39m=[32m"width: 100%; padding: 10px; color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; background: rgb(26, 115, 232);"[39m
              [36m>[39m
                [0m+ Nuova Chat[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 16px; text-align: center; color: rgb(95, 99, 104); font-size: 13px;"[39m
              [36m>[39m
                [0mNessuna chat. Creane una nuova![0m
              [36m</div>[39m
            [36m</div>[39m
          [36m</aside>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
              [36m>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                  [33mtitle[39m=[32m"Nascondi sidebar"[39m
                [36m>[39m
                  [0m✕[0m
                [36m</button>[39m
                [36m<div>[39m
                  [36m<h1[39m
                    [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                  [36m>[39m
                    [0mSeleziona o crea una chat[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mHome[0m
              [36m</a>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"text-align: center; padding: 48px; color: rgb(95, 99, 104);"[39m
              [36m>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 16px; margin-bottom: 8px;"[39m
                [36m>[39m
                  [0mNessun messaggio ancora.[0m
                [36m</p>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 14px;"[39m
                [36m>[39m
                  [0mSeleziona una chat esistente o creane una nuova per iniziare.[0m
                [36m</p>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<form[39m
              [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
            [36m>[39m
              [36m<input[39m
                [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                [33mtype[39m=[32m"text"[39m
                [33mvalue[39m=[32m""[39m
              [36m/>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                [33mtype[39m=[32m"submit"[39m
              [36m>[39m
                [0mInvia[0m
              [36m</button>[39m
            [36m</form>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 1740 |[39m
     [90m 1741 |[39m       [90m// Check chat preview includes date/time (format is locale-dependent)[39m
    [31m[1m>[22m[39m[90m 1742 |[39m       [36mconst[39m chatPreview [33m=[39m screen[33m.[39mgetAllByText([35m/\d{1,2}\/\d{1,2}\/\d{4}/[39m)[33m;[39m
     [90m      |[39m                                  [31m[1m^[22m[39m
     [90m 1743 |[39m       expect(chatPreview[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m0[39m)[33m;[39m
     [90m 1744 |[39m     })[33m;[39m
     [90m 1745 |[39m   })[33m;[39m[0m

      at Object.getElementError (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:109:15
      at Object.getAllByText (src/pages/__tests__/chat.test.tsx:1742:34)

  ● ChatPage › Edge Cases › handles null auth response gracefully

    TestingLibraryElementError: Unable to find an accessible element with the role "heading" and name `/Accesso richiesto/i`

    Here are the accessible roles:

      main:

      Name "":
      [36m<main[39m
        [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
      [36m/>[39m

      --------------------------------------------------
      complementary:

      Name "":
      [36m<aside[39m
        [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
      [36m/>[39m

      --------------------------------------------------
      heading:

      Name "MeepleAI Chat":
      [36m<h2[39m
        [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
      [36m/>[39m

      Name "Seleziona o crea una chat":
      [36m<h1[39m
        [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
      [36m/>[39m

      --------------------------------------------------
      combobox:

      Name "Gioco:":
      [36m<select[39m
        [33mdisabled[39m=[32m""[39m
        [33mid[39m=[32m"gameSelect"[39m
        [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
      [36m/>[39m

      Name "Agente:":
      [36m<select[39m
        [33mdisabled[39m=[32m""[39m
        [33mid[39m=[32m"agentSelect"[39m
        [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
      [36m/>[39m

      --------------------------------------------------
      option:

      Name "Seleziona un gioco...":
      [36m<option[39m
        [33mvalue[39m=[32m""[39m
      [36m/>[39m

      Name "Seleziona un agente...":
      [36m<option[39m
        [33mvalue[39m=[32m""[39m
      [36m/>[39m

      --------------------------------------------------
      button:

      Name "+ Nuova Chat":
      [36m<button[39m
        [33mdisabled[39m=[32m""[39m
        [33mstyle[39m=[32m"width: 100%; padding: 10px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
      [36m/>[39m

      Name "✕":
      [36m<button[39m
        [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
        [33mtitle[39m=[32m"Nascondi sidebar"[39m
      [36m/>[39m

      Name "Invia":
      [36m<button[39m
        [33mdisabled[39m=[32m""[39m
        [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
        [33mtype[39m=[32m"submit"[39m
      [36m/>[39m

      --------------------------------------------------
      paragraph:

      Name "":
      [36m<p[39m
        [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
      [36m/>[39m

      Name "":
      [36m<p[39m
        [33mstyle[39m=[32m"font-size: 16px; margin-bottom: 8px;"[39m
      [36m/>[39m

      Name "":
      [36m<p[39m
        [33mstyle[39m=[32m"font-size: 14px;"[39m
      [36m/>[39m

      --------------------------------------------------
      link:

      Name "Home":
      [36m<a[39m
        [33mhref[39m=[32m"/"[39m
        [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
      [36m/>[39m

      --------------------------------------------------
      textbox:

      Name "":
      [36m<input[39m
        [33mdisabled[39m=[32m""[39m
        [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
        [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
        [33mtype[39m=[32m"text"[39m
        [33mvalue[39m=[32m""[39m
      [36m/>[39m

      --------------------------------------------------

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
        [36m>[39m
          [36m<aside[39m
            [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
            [36m>[39m
              [36m<h2[39m
                [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
              [36m>[39m
                [0mMeepleAI Chat[0m
              [36m</h2>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mGioco:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mdisabled[39m=[32m""[39m
                  [33mid[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un gioco...[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mAgente:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mdisabled[39m=[32m""[39m
                  [33mid[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un agente...[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"width: 100%; padding: 10px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
              [36m>[39m
                [0m+ Nuova Chat[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 16px; text-align: center; color: rgb(95, 99, 104); font-size: 13px;"[39m
              [36m>[39m
                [0mNessuna chat. Creane una nuova![0m
              [36m</div>[39m
            [36m</div>[39m
          [36m</aside>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
              [36m>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                  [33mtitle[39m=[32m"Nascondi sidebar"[39m
                [36m>[39m
                  [0m✕[0m
                [36m</button>[39m
                [36m<div>[39m
                  [36m<h1[39m
                    [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                  [36m>[39m
                    [0mSeleziona o crea una chat[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                  [36m>[39m
                    [0mNessun gioco selezionato[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mHome[0m
              [36m</a>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"text-align: center; padding: 48px; color: rgb(95, 99, 104);"[39m
              [36m>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 16px; margin-bottom: 8px;"[39m
                [36m>[39m
                  [0mNessun messaggio ancora.[0m
                [36m</p>[39m
                [36m<p[39m
                  [33mstyle[39m=[32m"font-size: 14px;"[39m
                [36m>[39m
                  [0mSeleziona una chat esistente o creane una nuova per iniziare.[0m
                [36m</p>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<form[39m
              [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
            [36m>[39m
              [36m<input[39m
                [33mdisabled[39m=[32m""[39m
                [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                [33mtype[39m=[32m"text"[39m
                [33mvalue[39m=[32m""[39m
              [36m/>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                [33mtype[39m=[32m"submit"[39m
              [36m>[39m
                [0mInvia[0m
              [36m</button>[39m
            [36m</form>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 1757 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/auth/me'[39m))[33m;[39m
     [90m 1758 |[39m
    [31m[1m>[22m[39m[90m 1759 |[39m       expect(screen[33m.[39mgetByRole([32m'heading'[39m[33m,[39m { name[33m:[39m [35m/Accesso richiesto/i[39m }))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m      |[39m                     [31m[1m^[22m[39m
     [90m 1760 |[39m     })[33m;[39m
     [90m 1761 |[39m
     [90m 1762 |[39m     it([32m'handles empty games list'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.getElementError (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:37:19)
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:76:38
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:52:17
      at node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/query-helpers.js:95:19
      at Object.getByRole (src/pages/__tests__/chat.test.tsx:1759:21)

  ● ChatPage › Edge Cases › handles empty games list

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/games"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1766 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1767 |[39m
    [31m[1m>[22m[39m[90m 1768 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/games'[39m))[33m;[39m
     [90m      |[39m                                               [31m[1m^[22m[39m
     [90m 1769 |[39m
     [90m 1770 |[39m       [36mconst[39m gameSelect [33m=[39m screen[33m.[39mgetByLabelText([35m/Gioco:/i[39m)[33m;[39m
     [90m 1771 |[39m       expect(within(gameSelect)[33m.[39mqueryByText([32m'Chess'[39m))[33m.[39mnot[33m.[39mtoBeInTheDocument()[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1768:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Edge Cases › handles empty agents list

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/games/game-1/agents"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1780 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1781 |[39m
    [31m[1m>[22m[39m[90m 1782 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/games/game-1/agents'[39m))[33m;[39m
     [90m      |[39m                                               [31m[1m^[22m[39m
     [90m 1783 |[39m
     [90m 1784 |[39m       [36mconst[39m agentSelect [33m=[39m screen[33m.[39mgetByLabelText([35m/Agente:/i[39m)[33m;[39m
     [90m 1785 |[39m       expect(within(agentSelect)[33m.[39mqueryByText([32m'Chess Expert'[39m))[33m.[39mnot[33m.[39mtoBeInTheDocument()[33m;[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1782:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Edge Cases › handles chat with null lastMessageAt

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/chats?gameId=game-1"
    Received: "/auth/me"

    Number of calls: 1

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<main[39m
            [33mstyle[39m=[32m"padding: 24px; max-width: 900px; margin: 0px auto; font-family: sans-serif;"[39m
          [36m>[39m
            [36m<a[39m
              [33mhref[39m=[32m"/"[39m
              [33mstyle[39m=[32m"color: rgb(0, 112, 243); text-decoration: none;"[39m
            [36m>[39m
              [0m← Torna alla Home[0m
            [36m</a>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"margin-top: 24px; padding: 32px; text-align: center; border: 1px solid rgb(218, 220, 224); border-radius: 8px;"[39m
            [36m>[39m
              [36m<h2>[39m
                [0mAccesso richiesto[0m
              [36m</h2>[39m
              [36m<p>[39m
                [0mDevi effettuare l'accesso per utilizzare la chat.[0m
              [36m</p>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"display: inline-block; margin-top: 16px; padding: 8px 16px; background: rgb(0, 112, 243); color: white; text-decoration: none; border-radius: 4px;"[39m
              [36m>[39m
                [0mVai al Login[0m
              [36m</a>[39m
            [36m</div>[39m
          [36m</main>[39m
        [36m</div>[39m
      [36m</body>[39m
    [36m</html>[39m

    [0m [90m 1794 |[39m       render([33m<[39m[33mChatPage[39m [33m/[39m[33m>[39m)[33m;[39m
     [90m 1795 |[39m
    [31m[1m>[22m[39m[90m 1796 |[39m       [36mawait[39m waitFor(() [33m=>[39m expect(mockApi[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledWith([32m'/chats?gameId=game-1'[39m))[33m;[39m
     [90m      |[39m                                               [31m[1m^[22m[39m
     [90m 1797 |[39m
     [90m 1798 |[39m       [90m// Should use startedAt for preview[39m
     [90m 1799 |[39m       [90m// Use getAllByText since "Chess Helper" appears in multiple places (sidebar, select options)[39m[0m

      at toHaveBeenCalledWith (src/pages/__tests__/chat.test.tsx:1796:47)
      at runWithExpensiveErrorDiagnosticsDisabled (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:124:77)
      at checkRealTimersCallback (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/.pnpm/jsdom@26.1.0/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)

  ● ChatPage › Edge Cases › handles message with null metadata

    Unable to find an element with the text: Simple message. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mstyle[39m=[32m"font-family: sans-serif; display: flex; height: 100vh; overflow: hidden;"[39m
        [36m>[39m
          [36m<aside[39m
            [33mstyle[39m=[32m"width: 320px; min-width: 320px; background: rgb(248, 249, 250); border-right: 1px solid rgb(218, 220, 224); display: flex; flex-direction: column; overflow: hidden; transition: width 0.3s ease, min-width 0.3s ease;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224);"[39m
            [36m>[39m
              [36m<h2[39m
                [33mstyle[39m=[32m"margin: 0px 0px 16px 0px; font-size: 18px;"[39m
              [36m>[39m
                [0mMeepleAI Chat[0m
              [36m</h2>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mGioco:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"gameSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un gioco...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-1"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"game-2"[39m
                  [36m>[39m
                    [0mCatan[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 12px;"[39m
              [36m>[39m
                [36m<label[39m
                  [33mfor[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"display: block; margin-bottom: 6px; font-weight: 500; font-size: 13px;"[39m
                [36m>[39m
                  [0mAgente:[0m
                [36m</label>[39m
                [36m<select[39m
                  [33mid[39m=[32m"agentSelect"[39m
                  [33mstyle[39m=[32m"width: 100%; padding: 8px; font-size: 13px; border: 1px solid rgb(218, 220, 224); border-radius: 4px; background: white;"[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mSeleziona un agente...[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-1"[39m
                  [36m>[39m
                    [0mChess Expert[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m"agent-2"[39m
                  [36m>[39m
                    [0mChess Helper[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
              [36m<button[39m
                [33mstyle[39m=[32m"width: 100%; padding: 10px; color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: pointer; background: rgb(26, 115, 232);"[39m
              [36m>[39m
                [0m+ Nuova Chat[0m
              [36m</button>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 8px;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; border-radius: 4px; cursor: pointer; position: relative; font-size: 13px; background: rgb(232, 240, 254); border: 1px solid rgb(26, 115, 232);"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Expert[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Expert - 10/01/2025 11:05:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"padding: 12px; margin-bottom: 8px; background: white; border: 1px solid rgb(218, 220, 224); border-radius: 4px; cursor: pointer; position: relative; font-size: 13px;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                [36m>[39m
                  [0mChess Helper[0m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(95, 99, 104);"[39m
                [36m>[39m
                  [0mChess Helper - 09/01/2025 15:00:00[0m
                [36m</div>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"position: absolute; top: 8px; right: 8px; padding: 4px 8px; background: rgb(234, 67, 53); color: white; border-radius: 3px; font-size: 11px; cursor: pointer;"[39m
                  [33mtitle[39m=[32m"Elimina chat"[39m
                [36m>[39m
                  [0m🗑️[0m
                [36m</button>[39m
              [36m</div>[39m
            [36m</div>[39m
          [36m</aside>[39m
          [36m<div[39m
            [33mstyle[39m=[32m"flex: 1 1 0%; display: flex; flex-direction: column; overflow: hidden;"[39m
          [36m>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"padding: 16px; border-bottom: 1px solid rgb(218, 220, 224); display: flex; justify-content: space-between; align-items: center; background: white;"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"display: flex; align-items: center; gap: 12px;"[39m
              [36m>[39m
                [36m<button[39m
                  [33mstyle[39m=[32m"padding: 8px 12px; background: rgb(241, 243, 244); border-radius: 4px; cursor: pointer; font-size: 18px;"[39m
                  [33mtitle[39m=[32m"Nascondi sidebar"[39m
                [36m>[39m
                  [0m✕[0m
                [36m</button>[39m
                [36m<div>[39m
                  [36m<h1[39m
                    [33mstyle[39m=[32m"margin: 0px; font-size: 20px;"[39m
                  [36m>[39m
                    [0mChess Expert[0m
                  [36m</h1>[39m
                  [36m<p[39m
                    [33mstyle[39m=[32m"margin: 4px 0px 0px 0px; color: rgb(95, 99, 104); font-size: 13px;"[39m
                  [36m>[39m
                    [0mChess[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<a[39m
                [33mhref[39m=[32m"/"[39m
                [33mstyle[39m=[32m"padding: 8px 16px; background: rgb(26, 115, 232); color: white; text-decoration: none; border-radius: 4px; font-size: 14px;"[39m
              [36m>[39m
                [0mHome[0m
              [36m</a>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mstyle[39m=[32m"flex: 1 1 0%; overflow-y: auto; padding: 24px; background: rgb(255, 255, 255);"[39m
            [36m>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 24px; display: flex; flex-direction: column; align-items: flex-end;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"max-width: 75%; padding: 12px; border-radius: 8px; background: rgb(227, 242, 253); font-size: 14px; line-height: 1.5;"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px; font-size: 12px; color: rgb(95, 99, 104);"[39m
                  [36m>[39m
                    [0mTu[0m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mstyle[39m=[32m"white-space: pre-wrap;"[39m
                  [36m>[39m
                    [0mHow do I castle?[0m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(154, 160, 166); margin-top: 4px;"[39m
                [36m>[39m
                  [0m11:00:00[0m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mstyle[39m=[32m"margin-bottom: 24px; display: flex; flex-direction: column; align-items: flex-start;"[39m
              [36m>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"max-width: 75%; padding: 12px; border-radius: 8px; background: rgb(241, 243, 244); font-size: 14px; line-height: 1.5;"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px; font-size: 12px; color: rgb(95, 99, 104);"[39m
                  [36m>[39m
                    [0mMeepleAI[0m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mstyle[39m=[32m"white-space: pre-wrap;"[39m
                  [36m>[39m
                    [0mCastling is a special move...[0m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mstyle[39m=[32m"margin-top: 12px; padding-top: 12px; border-top: 1px solid rgb(218, 220, 224);"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mstyle[39m=[32m"font-size: 12px; font-weight: 500; margin-bottom: 8px; color: rgb(95, 99, 104);"[39m
                    [36m>[39m
                      [0mFonti:[0m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mstyle[39m=[32m"margin-bottom: 8px; padding: 8px; background: rgb(255, 255, 255); border: 1px solid rgb(218, 220, 224); border-radius: 4px; font-size: 12px;"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mstyle[39m=[32m"font-weight: 500; margin-bottom: 4px;"[39m
                      [36m>[39m
                        [0mchess-rules.pdf (Pagina 5)[0m
                      [36m</div>[39m
                      [36m<div[39m
                        [33mstyle[39m=[32m"color: rgb(95, 99, 104); font-size: 11px;"[39m
                      [36m>[39m
                        [0mCastling rules section[0m
                      [36m</div>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"display: flex; gap: 8px; margin-top: 8px;"[39m
                [36m>[39m
                  [36m<button[39m
                    [33mstyle[39m=[32m"padding: 4px 8px; background: rgb(241, 243, 244); color: rgb(95, 99, 104); border-radius: 4px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 4px;"[39m
                    [33mtitle[39m=[32m"Questa risposta è stata utile"[39m
                  [36m>[39m
                    [0m👍 Utile[0m
                  [36m</button>[39m
                  [36m<button[39m
                    [33mstyle[39m=[32m"padding: 4px 8px; background: rgb(241, 243, 244); color: rgb(95, 99, 104); border-radius: 4px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 4px;"[39m
                    [33mtitle[39m=[32m"Questa risposta non è stata utile"[39m
                  [36m>[39m
                    [0m👎 Non utile[0m
                  [36m</button>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mstyle[39m=[32m"font-size: 11px; color: rgb(154, 160, 166); margin-top: 4px;"[39m
                [36m>[39m
                  [0m11:05:00[0m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<form[39m
              [33mstyle[39m=[32m"padding: 16px; border-top: 1px solid rgb(218, 220, 224); background: white; display: flex; gap: 8px;"[39m
            [36m>[39m
              [36m<input[39m
                [33mplaceholder[39m=[32m"Fai una domanda sul gioco..."[39m
                [33mstyle[39m=[32m"flex: 1 1 0%; padding: 12px; font-size: 14px; border: 1px solid rgb(218, 220, 224); border-radius: 4px;"[39m
                [33mtype[39m=[32m"text"[39m
                [33mvalue[39m=[32m""[39m
              [36m/>[39m
              [36m<button[39m
                [33mdisabled[39m=[32m""[39m
                [33mstyle[39m=[32m"padding: 12px 24px; background: rgb(218, 220, 224); color: white; border-radius: 4px; font-size: 14px; font-weight: 500; cursor: not-allowed;"[39m
                [33mtype[39m=[32m"submit"[39m
              [36m>[39m
                [0mInvia[0m
              [36m</button>[39m
            [36m</form>[39m
          [36m</div>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

    [0m [90m 1831 |[39m       [36mawait[39m user[33m.[39mclick(chatItems[chatItems[33m.[39mlength [33m-[39m [35m1[39m])[33m;[39m
     [90m 1832 |[39m
    [31m[1m>[22m[39m[90m 1833 |[39m       [36mawait[39m waitFor(() [33m=>[39m {
     [90m      |[39m                    [31m[1m^[22m[39m
     [90m 1834 |[39m         expect(screen[33m.[39mgetByText([32m'Simple message'[39m))[33m.[39mtoBeInTheDocument()[33m;[39m
     [90m 1835 |[39m       })[33m;[39m
     [90m 1836 |[39m[0m

      at waitForWrapper (node_modules/.pnpm/@testing-library+dom@10.4.1/node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/pages/__tests__/chat.test.tsx:1833:20)

Test Suites: 1 failed, 1 total
Tests:       44 failed, 30 passed, 74 total
Snapshots:   0 total
Time:        43.596 s
Ran all test suites matching chat.test.tsx.
